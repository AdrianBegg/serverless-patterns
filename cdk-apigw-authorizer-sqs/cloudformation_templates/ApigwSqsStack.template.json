{
 "Parameters": {
  "storagequeue": {
   "Type": "String",
   "Default": "storagequeue-noauth",
   "Description": "Enter the name of the Amazon SQS queue where events will be stored."
  },
  "awsregion": {
   "Type": "String",
   "Default": "us-east-1",
   "Description": "Enter the AWS region name where the resources need to be deployed."
  },
  "authorizerneeded": {
   "Type": "String",
   "Default": "No",
   "AllowedValues": [
    "No"
   ],
   "Description": "This stack does not take create an Authorizer."
  }
 },
 "Resources": {
  "storagesqs804AFF47": {
   "Type": "AWS::SQS::Queue",
   "Properties": {
    "KmsMasterKeyId": "alias/aws/sqs",
    "QueueName": {
     "Ref": "storagequeue"
    }
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/storagesqs/Resource"
   }
  },
  "sqspolicyforapigw2BC99F9A": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "sqs:SendMessage",
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "storagesqs804AFF47",
         "Arn"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "sqspolicyforapigw2BC99F9A",
    "Roles": [
     {
      "Ref": "apigwroleDF16DA28"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/sqs-policy-for-apigw/Resource"
   }
  },
  "apigwroleDF16DA28": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": [
         "apigateway.amazonaws.com",
         "lambda.amazonaws.com"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Description": "This is the role for apigateway to access SQS queue."
   },
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/apigw_role/Resource"
   }
  },
  "sqsapinoauthCEE24C1E": {
   "Type": "AWS::ApiGateway::RestApi",
   "Properties": {
    "Description": {
     "Fn::Join": [
      "",
      [
       "This api will insert data into SQS ",
       {
        "Fn::GetAtt": [
         "storagesqs804AFF47",
         "QueueName"
        ]
       }
      ]
     ]
    },
    "EndpointConfiguration": {
     "Types": [
      "REGIONAL"
     ]
    },
    "Name": "sqsapi-noauth"
   },
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/sqsapi-noauth/Resource"
   }
  },
  "sqsapinoauthCloudWatchRole2009BB0A": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "apigateway.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"
       ]
      ]
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/sqsapi-noauth/CloudWatchRole/Resource"
   }
  },
  "sqsapinoauthAccount8E5ACE46": {
   "Type": "AWS::ApiGateway::Account",
   "Properties": {
    "CloudWatchRoleArn": {
     "Fn::GetAtt": [
      "sqsapinoauthCloudWatchRole2009BB0A",
      "Arn"
     ]
    }
   },
   "DependsOn": [
    "sqsapinoauthCEE24C1E"
   ],
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/sqsapi-noauth/Account"
   }
  },
  "sqsapinoauthDeploymentFB2E2940e78b54332b9b1d7e93a5431dd3fd4ffd": {
   "Type": "AWS::ApiGateway::Deployment",
   "Properties": {
    "RestApiId": {
     "Ref": "sqsapinoauthCEE24C1E"
    },
    "Description": "Automatically created by the RestApi construct"
   },
   "DependsOn": [
    "sqsapinoauthsqsPOSTF615182B",
    "sqsapinoauthsqs760F7132"
   ],
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/sqsapi-noauth/Deployment/Resource"
   }
  },
  "sqsapinoauthDeploymentStageprodB4D5687B": {
   "Type": "AWS::ApiGateway::Stage",
   "Properties": {
    "RestApiId": {
     "Ref": "sqsapinoauthCEE24C1E"
    },
    "DeploymentId": {
     "Ref": "sqsapinoauthDeploymentFB2E2940e78b54332b9b1d7e93a5431dd3fd4ffd"
    },
    "StageName": "prod"
   },
   "DependsOn": [
    "sqsapinoauthAccount8E5ACE46"
   ],
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/sqsapi-noauth/DeploymentStage.prod/Resource"
   }
  },
  "sqsapinoauthsqs760F7132": {
   "Type": "AWS::ApiGateway::Resource",
   "Properties": {
    "ParentId": {
     "Fn::GetAtt": [
      "sqsapinoauthCEE24C1E",
      "RootResourceId"
     ]
    },
    "PathPart": "sqs",
    "RestApiId": {
     "Ref": "sqsapinoauthCEE24C1E"
    }
   },
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/sqsapi-noauth/Default/sqs/Resource"
   }
  },
  "sqsapinoauthsqsPOSTF615182B": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "HttpMethod": "POST",
    "ResourceId": {
     "Ref": "sqsapinoauthsqs760F7132"
    },
    "RestApiId": {
     "Ref": "sqsapinoauthCEE24C1E"
    },
    "AuthorizationType": "NONE",
    "Integration": {
     "Credentials": {
      "Fn::GetAtt": [
       "apigwroleDF16DA28",
       "Arn"
      ]
     },
     "IntegrationHttpMethod": "POST",
     "IntegrationResponses": [
      {
       "StatusCode": "200"
      }
     ],
     "PassthroughBehavior": "NEVER",
     "RequestParameters": {
      "integration.request.header.Content-Type": "'application/x-www-form-urlencoded'"
     },
     "RequestTemplates": {
      "application/json": "Action=SendMessage&MessageBody=$input.body"
     },
     "Type": "AWS",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":apigateway:",
        {
         "Ref": "awsregion"
        },
        ":sqs:path/",
        {
         "Fn::GetAtt": [
          "storagesqs804AFF47",
          "QueueName"
         ]
        }
       ]
      ]
     }
    },
    "MethodResponses": [
     {
      "StatusCode": "200"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/sqsapi-noauth/Default/sqs/POST/Resource"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/1WPwW7CMAyGn4V7MFRcxm2MXRFd9wRR6oFHG3eJI1RFefcl6dC2k7/fTvz/bqDZP0GzetZ3vzb9bRMNO4T4Ltrc1PHDttrpEQVdEecgUxB1ZOvFBSOl16Hn4AwWzoOehNgmVfZF/+UhvgUMdVohKdIjxJYHMnM1WKjjoT4qNf+e6KIF73qGmA3kMNGP1wMPxnCwol5xGnge0dYwf1S+4FI3LvCI+aL9r/iX/4Ry5b60FkopqXbOZDc7aLawX316orXLrjQidEv9BgpX2WpBAQAA"
   },
   "Metadata": {
    "aws:cdk:path": "ApigwSqsStack/CDKMetadata/Default"
   },
   "Condition": "CDKMetadataAvailable"
  }
 },
 "Outputs": {
  "sqsapinoauthEndpointB1F40CDE": {
   "Value": {
    "Fn::Join": [
     "",
     [
      "https://",
      {
       "Ref": "sqsapinoauthCEE24C1E"
      },
      ".execute-api.",
      {
       "Ref": "AWS::Region"
      },
      ".",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/",
      {
       "Ref": "sqsapinoauthDeploymentStageprodB4D5687B"
      },
      "/"
     ]
    ]
   }
  }
 },
 "Conditions": {
  "CDKMetadataAvailable": {
   "Fn::Or": [
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "af-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ca-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "cn-north-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "cn-northwest-1"
       ]
      }
     ]
    },
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-north-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-3"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "me-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "sa-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-east-2"
       ]
      }
     ]
    },
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-west-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-west-2"
       ]
      }
     ]
    }
   ]
  }
 }
}